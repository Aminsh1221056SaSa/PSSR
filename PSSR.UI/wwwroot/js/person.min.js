var person=person||function(){function i(n){t=n}function r(){n&&(n.clear().draw(),n.destroy());$("form[name='personForm']").validate({rules:{firstName:"required",lastName:"required",nationalId:{required:!0,minlength:10},mobileNumber:{required:!0,minlength:7}},messages:{firstName:"Please enter Person First Name",lastName:"Please enter Person Last Name",nationalId:{required:"Please enter Person National code",minlength:"Person Natioanl Code must consist of at least 6 characters"},mobileNumber:{required:"Please enter a mobile number",minlength:"Person mobile number must consist of at least 7 characters"}},errorElement:"em",errorPlacement:function(n,t){n.addClass("invalid-feedback");t.prop("type")==="checkbox"?n.insertAfter(t.next("label")):n.insertAfter(t)},highlight:function(n){$(n).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(n){$(n).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(){var n=$("input#firstName").val(),t=$("input#lastName").val(),i=$("input#nationalId").val(),r=$("textarea#mobileNumber").val();e(n,t,i,r)}});$("form[name='personEditForm']").validate({rules:{firstName:"required",lastName:"required",nationalId:{required:!0,minlength:10},mobileNumber:{required:!0,minlength:7}},messages:{firstName:"Please enter Person First Name",lastName:"Please enter Person Last Name",nationalId:{required:"Please enter Person National code",minlength:"Person Natioanl Code must consist of at least 6 characters"},mobileNumber:{required:"Please enter a mobile number",minlength:"Person mobile number must consist of at least 7 characters"}},errorElement:"em",errorPlacement:function(n,t){n.addClass("invalid-feedback");t.prop("type")==="checkbox"?n.insertAfter(t.next("label")):n.insertAfter(t)},highlight:function(n){$(n).addClass("is-invalid").removeClass("is-valid")},unhighlight:function(n){$(n).addClass("is-valid").removeClass("is-invalid")},submitHandler:function(){var n=$("input#editfirstName").val(),t=$("input#editlastName").val(),i=$("input#editnationalId").val(),r=$("textarea#editmobileNumber").val(),u=$("#current-personId").val();o(n,t,i,r,u)}})}function u(){var t=$("#person-content");t.empty();$.ajax({type:"Get",url:"/APSE/Person/GetPersons",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){$.each(i,function(n,i){var u=$("<td>"+i.name+"<\/td>"),f=$("<td>"+i.nationalId+"<\/td>"),e=$("<td><button  data-toggle='modal' data-target='#edit-personModal' data-id='"+i.id+"' class='edit-person btn btn-indigo btn-icon' style='height:28px;min-height:28px'><i style='line-height:0.4;color: #FFF;' class='typcn typcn-edit'><\/i><\/button><\/td>"),o=$("<td><button data-id='"+i.id+"' class='delete-person btn  btn-danger btn-icon' style='height:28px;min-height:28px'><i style='line-height:0.4;color: #FFF;' class='typcn typcn-delete'><\/i><\/button><\/td>"),r=$("<tr><\/tr>");r.append(u).append(f).append(e).append(o);t.append(r)});n=h()},error:function(n){console.log(n)}})}function f(n){return $.ajax({type:"Get",url:"/APSE/Person/GetPerson/"+n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(){},error:function(n){console.log(n)}})}function e(t,i,r,u){var f={firstName:t,lastName:i,nationalId:r,mobileNumber:u};$.ajax({type:"Post",url:"/APSE/Person/CreatePerson",data:JSON.stringify(f),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){t.key==200?n&&n.row.add([name,r,"<button  data-toggle='modal' data-target='#edit-personModal' data-id='"+t.subject+"' class='edit-person btn btn-indigo btn-icon' style='height:28px;min-height:28px'><i style='line-height:0.4;color: #FFF;' class='typcn typcn-edit'><\/i><\/button><\/td>","<button  data-toggle='modal' data-id='"+t.subject+"' class='delete-person btn  btn-danger btn-icon' style='height:28px;min-height:28px'><i style='line-height:0.4;color: #FFF;' class='typcn typcn-delete'><\/i><\/button>"]).draw(!1):alert(t.value)},error:function(n){console.log(n)}})}function o(i,r,u,f,e){var o={firstName:i,lastName:r,nationalId:u,mobileNumber:f};$.ajax({type:"PUT",url:"/APSE/Person/UpdatePerson/"+e,data:JSON.stringify(o),contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){i.key==200?n&&(n.row(":eq("+t+")").data([name,u,"<button  data-toggle='modal' data-target='#edit-personModal' data-id='"+i.subject+"' class='edit-person btn btn-indigo btn-icon' style='height:28px;min-height:28px'><i style='line-height:0.4;color: #FFF;' class='typcn typcn-edit'><\/i><\/button><\/td>","<button  data-toggle='modal' data-id='"+i.subject+"' class='delete-person btn  btn-danger btn-icon' style='height:28px;min-height:28px'><i style='line-height:0.4;color: #FFF;' class='typcn typcn-delete'><\/i><\/button>"]),$("#edit-contractorModal").modal("toggle")):alert(i.value)},error:function(n){console.log(n)}})}function s(i){$.ajax({type:"Delete",url:"/APSE/Person/DeletePerson/"+i,contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){i.key==200?n&&n.row(":eq("+t+")").remove().draw(!1):alert(i.value)},error:function(n){console.log(n)}})}function h(){var n=window.innerHeight*.45;return $("#personLst").DataTable({responsive:!0,FixedHeader:!0,scrollY:n+"px",dom:"Bfrtip",buttons:[{text:"",extend:"excelHtml5",className:"btn btn-success btn-sm",exportOptions:{modifier:{page:"all"}},init:function(n,t){$(t).removeClass("dt-button");$(t).append('<p class="" style="height:1px;"><i style="font-size:20px;color:#FFF;" class="fa fa-file-excel"><\/i><p>')},extension:".xlsx",filename:"Persons",messageTop:"Persons",customize:function(n){var t=n.xl.worksheets["sheet1.xml"];$("row",t).each(function(n){n>2&&(n%2==0?$("row:nth-child("+(n+1)+") c",t).attr("s","10"):$("row:nth-child("+(n+1)+") c",t).attr("s","20"))})}},{extend:"print",text:"",className:"btn btn-warning btn-sm",exportOptions:{modifier:{page:"all"}},init:function(n,t){$(t).removeClass("dt-button");$(t).append('<p class="" style="height:1px;"><i style="font-size:20px;color:#FFF;" class="fa fa-print"><\/i><p>')}}],scrollCollapse:!0,scroller:!0,fnInitComplete:function(){const n=new PerfectScrollbar(".dataTables_scrollBody")},fnDrawCallback:function(){$(".dataTables_scrollBody").each(function(){if(!$(this).hasClass("ps"))const n=new PerfectScrollbar($(this)[0]);$(this)[0].scrollTop=0})}})}return{init:function(){r()},getPersonList:function(){u()},getPerson:function(n){return f(n)},setCurrentIndex:function(n){i(n)},removePerson:function(n){s(n)}};var n,t}();