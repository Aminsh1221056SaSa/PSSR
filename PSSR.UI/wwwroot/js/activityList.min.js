var wbsActivityList=wbsActivityList||function(){function i(n){$("#modal-default-overlay").modal("show");var t=parseInt(n);r(t)}function r(i){$.ajax({type:"Get",url:"/poec/WBS/GetProjectWBSActivityTree?parentId="+i,contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){n();$.each(i,function(n,t){f(t,n)});t();$("#modal-default-overlay").modal("toggle");$("#modal-wbs-actvivityList").modal("show")},error:function(n){console.log(n)}})}function u(i,r,u,f,o){$("#modal-default-overlay").modal("toggle");$.ajax({type:"Get",url:"/poec/Project/GetProjectPlanActivity?workPackageId="+i+"&locationId="+r+"&subsystemId="+u+"&desciplineId="+f+"&formId="+o,contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){n();$.each(i,function(n,t){e(t,n)});t();$("#modal-default-overlay").modal("toggle");$("#modal-wbs-actvivityPlanList").modal("show")},error:function(n){console.log(n)}})}function f(n,t){t=t+1;var i=$("<tr id='tr-"+n.id+"' data-name='name-"+n.name+"'><\/tr>");i.append("<td>"+t+"<\/td>");i.append("<td>"+n.name+"<\/td>");i.append("<td>"+n.wbsCode+"<\/td>");i.append("<td>"+n.wf+"<\/td>");i.append("<td>"+n.wf+"<\/td>");i.append("<td>"+n.wf+"<\/td>");$("#wbs-acList").append(i)}function e(n,t){t=t+1;var i=$("<tr id='tr-"+n.id+"' data-name='name-"+n.activityCode+"'><\/tr>");i.append("<td>"+t+"<\/td>");i.append("<td>"+n.activityCode+"<\/td>");i.append("<td>"+o(n.status)+"<\/td>");i.append("<td>"+n.wf+"<\/td>");i.append("<td>"+n.startDate+"<\/td>");i.append("<td>"+n.startTime+"<\/td>");i.append("<td>"+n.endDate+"<\/td>");i.append("<td>"+n.endTime+"<\/td>");$("#wbs-acList").append(i)}function n(){var n=$("#wbsCreatorTableList").DataTable();n.clear().draw();n.destroy()}function t(){var n=$("#wbsCreatorTableList").DataTable({dom:'<"row"<"col-sm-12 col-md-1"B><"col-sm-12 col-md-7"l><"col-sm-12 col-md-3  text-left"i>><"row"<"col-sm-12"tr>><"row"<"col-sm-12 col-md-12"p>>',buttons:[{text:"",extend:"excelHtml5",collectionLayout:"fixed two-column ",className:"btn btn-success btn-sm",exportOptions:{modifier:{page:"current"}},init:function(n,t){$(t).removeClass("dt-button");$(t).append('<p class="" style="height:8px"><i style="font-size:16px;color:#FFF;" class="fa fa-file-excel-o"><\/i><p>')},extension:".xlsx",filename:"PlanActivityes",messageTop:"Plan Activity",customize:function(n){var t=n.xl.worksheets["sheet1.xml"];$("row",t).each(function(n){n>2&&(n%2==0?$("row:nth-child("+(n+1)+") c",t).attr("s","10"):$("row:nth-child("+(n+1)+") c",t).attr("s","20"))})}}]})}function o(n){var t="";switch(n){case 1:t="NotStarted";break;case 2:t="Ongoing";break;case 3:t="Done";break;case 4:t="Reject"}return t}return{init:function(){},lastwbsChildClick:function(n){i(n)},getProjectPlanActivity:function(n,t,i,r,f){u(n,t,i,r,f)}}}();