g=new JSGantt.GanttChart("g",document.getElementById("GanttChartDIV"),"day");var WBSTreeConfig=WBSTreeConfig||function(){function h(n){g.setShowInput(0);g.setShowRes(0);g.setShowDur(0);g.setShowComp(1);g.setShowStartDate(0);g.setShowEndDate(0);g.setCaptionType("Resource");g?(g!=null&&(g=new JSGantt.GanttChart("g",document.getElementById("GanttChartDIV"),"day"),g.setShowInput(0),g.setShowRes(0),g.setShowDur(0),g.setShowComp(1),g.setShowStartDate(0),g.setShowEndDate(0),g.setCaptionType("Resource")),c(n)):alert("not defined")}function c(n){$("#wbs-creator-loading").show();$.ajax({type:"Get",url:"/poec/WBS/GetProjectWBSTree",contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){$.each(t,function(t,r){r.Childeren.length?(g.AddTaskItem(new JSGantt.TaskItem(r.Id,r.WBSCode,"8/15/2008","8/24/2008","ff0000","",0,i(r.Type),r.WF,1,0,1,r.Name)),f(r.Childeren,n)):g.AddTaskItem(new JSGantt.TaskItem(r.Id,r.WBSCode,"8/15/2008","8/24/2008","ff0000","",0,i(r.Type),r.WF,0,0,1,r.Name))});$("#wbs-creator-loading").hide();l()},error:function(n){console.log(n)}})}function f(n,t){$.each(n,function(n,r){r.Childeren.length?(g.AddTaskItem(new JSGantt.TaskItem(r.Id,r.WBSCode,"7/20/2008","7/20/2008","f600f6","",0,i(r.Type),r.WF,1,r.ParentId,0,r.Name)),f(r.Childeren,t)):g.AddTaskItem(new JSGantt.TaskItem(r.Id,r.WBSCode,"7/20/2008","7/20/2008","f600f6","",0,i(r.Type),r.WF,0,r.ParentId,0,r.Name))})}function l(){g.Draw("WBS Code","Duration","Wf(%)","Start Date","End Date","Name","NextName","NextName");g.HidenRightside();$("#leftside").css("width","100%");$("#theTable-firsttd").css("width","100%");$("#theTable-second").css("width","100%");$("#jsgantt-bottom").hide();var n=window.innerHeight*.63;$("#theTable-second").DataTable({scrollY:n+"px",fixedHeader:!0,colReorder:!0,autoWidth:!0})}function i(n){var t="";switch(n){case 1001:t="Project";break;case 1002:t="Work Package";break;case 1003:t="Location";break;case 1004:t="Descipline";break;case 1005:t="System";break;case 1006:t="SubSystem";break;case 1007:t="MDR"}return t}function a(n){$.ajax({type:"Get",url:"/poec/WBS/GetProjectWBSTree/",contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){$.each(t,function(t,i){v(i.Name,i.Id,i.WBSCode,n);e(i.Childeren,n)})},error:function(n){console.log(n)}})}function v(n,t,i,r){var e="realnode-"+t,o=$("#first-li-wbs-real"),u=$("<a id='"+e+"' data-wbsCode='"+i+"' class='drop-wbs'><p  style='width:60px;height:10px'>"+n+"<\/p><p class='html-wbsCode' style='width:60px;height:10px'>"+i+"<\/p><\/a>"),f=$(' <ul id="dr-ul-1001"><\/ul>');o.append(u);f.append(f);u.droppable({drop:function(n,t){var u=t.draggable.attr("id").split("-")[1],i=t.draggable.attr("data-name"),f=$(this).attr("id");$("#wbs-edit-title").html("Add WBS Item ("+i+")");$("#selected-wbs-name").val(i);$("#selected-wbs-targetid").val(u);$("#drop-wbs-id").val(f);s(r)}})}function e(n,t){$.each(n,function(n,i){if(t.indexOf(i.Type)>-1){var r=$("#realnode-"+i.ParentId+"");o(i.Name,i.Id,i.WBSCode,r,i.Type,t);i.Childeren.length&&e(i.Childeren,t)}})}function o(n,t,i,r,u,f){var o,h,c;if(n=n.split("(")[0],o="realnode-"+t,h=$(r).parent(),h.children("ul").length){var v=h.children("ul").first(),e=$("<li><\/li>"),l=$("<a id='"+o+"' data-wbsCode='"+i+"' class='drop-wbs'><p style='width:auto;height:10px'>"+n+"<\/p><p class='html-wbsCode text-center'  style='width:auto;height:10px'>"+i+"<\/p><\/a>");e.append(l);u==1005&&(c=$("<div><p data-sbId='"+o+"' class='btn btn-default sh-subsystem'><span class= 'badge bg-yellow' ><i class='fa fa-arrow-down'><\/i><\/span ><\/p><\/div>"),e.append(c));v.append(e)}else{var a=$("<ul><\/ul>"),e=$("<li style='margin-left:-45px;'><\/li>"),l=$("<a id='"+o+"' class='drop-wbs' data-wbsCode='"+i+"'><p style='width:auto;height:10px'>"+n+"<\/p><p class='html-wbsCode text-center' style='width:auto;height:10px'>"+i+"<\/p><\/a>");e.append(l);u==1005&&(c=$("<div><p data-sbId='"+o+"' class='btn btn-default sh-subsystem'><span class= 'badge bg-yellow' ><i class='fa fa-arrow-down'><\/i><\/span ><\/p><\/div>"),e.append(c));a.append(e);h.append(a)}l.droppable({classes:{"ui-droppable-active":"ui-state-active","ui-droppable-hover":"ui-state-hover"},drop:function(n,t){var r=t.draggable.attr("id").split("-")[1],i=t.draggable.attr("data-name"),u=$(this).attr("id");$("#wbs-edit-title").html("Add WBS Item ("+i+")");$("#selected-wbs-name").val(i);$("#selected-wbs-targetid").val(r);$("#drop-wbs-id").val(u);s(f)}})}function s(n){var t=$("#drop-wbs-id").val(),i=$("#drop-wbs-id").val().split("-")[1],s=document.getElementById(t),r=$("#selected-wbs-name").val(),u=$("#selected-wbs-targetid").val(),f=$("#wbs-type").val(),e={Type:f,TargetId:u,Wf:0,Name:r,ParentId:i};$("#modal-default-overlay").modal("show");$.ajax({type:"Post",url:"/poec/WBS/CreateProjectWBS",data:JSON.stringify(e),contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){$("#modal-default-overlay").modal("toggle");t.key==200?t.model!=null&&$.each(t.model,function(t,i){var r=$("#realnode-"+i.parentId+"");n.indexOf(i.type)>-1&&o(i.name,i.id,i.wbsCode,r,i.type,n)}):($("#global-error-message").html(t.value),$("#modal-danger").modal("show"))},error:function(n){console.log(n)}})}function y(n,t){var i=parseInt(t);$.ajax({type:"Get",url:"/poec/WBS/GetProjectWBSTree/",contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){$.each(t,function(t,r){u(r.Childeren,n,i)})},error:function(n){console.log(n)}})}function u(n,t,i){$.each(n,function(n,r){if(r.Type<1006)if(r.Id==i){var f=90;p(r.Name,r.Id,r.WBSCode);$.each(r.Childeren,function(n,i){var r=$("#sysId-"+i.ParentId+"");w(i.Name,i.Id,i.WBSCode,r,i.Type,t);f+=90});f<window.innerWidth?$(".modal-lg").width(f):$(".modal-lg").width(window.innerWidth-100)}else r.Childeren.length&&u(r.Childeren,t,i);else r.Childeren.length&&u(r.Childeren,t,i)})}function p(n,t,i){n=n.split("(")[0];var u="sysId-"+t,f=$("#first-li-wbs1"),e=$("<a id='"+u+"' class='drop-wbs'><p  style='width:60px;height:10px'>"+n+"<\/p><p class='html-wbsCode text-center' style='width:auto;height:10px'>"+i+"<\/p><\/a>"),r=$('<ul id="pr-ul-1001"><\/ul>');f.append(e);r.append(r)}function w(n,t,i,r,u,f){var o,s,h;if(n=n.split("(")[0],o="sysId-"+t,s=$(r).parent(),s.children("ul").length){var a=s.children("ul").first(),e=$("<li><\/li>"),c=$("<a id='"+o+"' data-wbsCode='"+i+"' class='drop-wbs'><p style='width:60px;height:10px'>"+n+"<\/p><p class='html-wbsCode text-center' style='width:60px;height:10px'>"+i+"<\/p><\/a>");u!=1005||f.indexOf(1006)>-1||(h=$("<div><p data-sbId='"+o+"' class='btn btn-default sh-subsystem'><span class= 'badge bg-yellow' ><i class='fa fa-arrow-down'><\/i><\/span ><\/p><\/div>"));e.append(c);e.append(h);a.append(e)}else{var l=$("<ul><\/ul>"),e=$("<li><\/li>"),c=$("<a id='"+o+"' class='drop-wbs' data-wbsCode='"+i+"'><p style='width:60px;height:10px'>"+n+"<\/p><p class='html-wbsCode text-center' style='width:60px;height:10px'>"+i+"<\/p><\/a>");u!=1005||f.indexOf(1006)>-1||(h=$("<div><p data-sbId='"+o+"' class='btn btn-default sh-subsystem'><span class= 'badge bg-yellow' ><i class='fa fa-arrow-down'><\/i><\/span ><\/p><\/div>"));e.append(c);e.append(h);l.append(e);s.append(l)}}function b(n,t){var r=t.draggable.attr("id").split("-")[1],i=t.draggable.attr("data-name"),u=$(this).attr("id");$("#wbs-edit-title").html("Add WBS Item ("+i+")");$("#selected-wbs-name").val(i);$("#selected-wbs-targetid").val(r);$("#drop-wbs-id").val(u);$("#modal-default-wbsEdit").modal("show")}function k(){$.ajax({type:"Get",url:"/poec/WorkPackage/GetRoadMaps",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){n();$.each(i,function(n,t){r(t,n)});t()},error:function(n){console.log(n)}})}function d(){$.ajax({type:"Get",url:"/poec/WorkPackage/GetLocations",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){n();$.each(i,function(n,t){r(t,n)});t()},error:function(n){console.log(n)}})}function nt(){$.ajax({type:"Get",url:"/poec/Descipline/GetDesciplineList",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){n();$.each(i,function(n,t){r(t,n)});t()},error:function(n){console.log(n)}})}function tt(){$.ajax({type:"Get",url:"/poec/ProjectSystem/GetProjectSystems",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){n();$.each(i,function(n,t){r(t,n)});t()},error:function(n){console.log(n)}})}function it(){$.ajax({type:"Get",url:"/poec/SubSystem/GetProjectSubSystems",contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){n();$.each(i,function(n,t){rt(t,n)});t()},error:function(n){console.log(n)}})}function r(n,t){var i,r;t=t+1;i=n.title;n.description&&(i+="("+n.description+")");r=$("<tr id='tr-"+n.id+"' data-name='"+i+"' ><\/tr>");r.append("<td>"+i+"<\/td>");r.draggable({appendTo:"body",helper:function(){var t=$(this),n=$("<div/>");return n.append(t.clone()),n}});$("#model-items").append(r)}function rt(n,t){var i,r;t=t+1;i=n.title;n.description&&(i+="("+n.description+")");r=$("<tr id='tr-"+n.id+"' data-name='"+i+"' ><\/tr>");r.append("<td>"+i+"<\/td>");r.draggable({appendTo:"body",helper:function(){var t=$(this),n=$("<div/>");return n.append(t.clone()),n}});$("#model-items").append(r)}function ut(n){var t=n.split("-")[1];$("#modal-default-overlay").modal("show");$.ajax({type:"Get",url:"/poec/WBS/GetProjectWBS?wbsId="+t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){$("#modal-default-overlay").modal("toggle");$("#delete-wbs-id").val(n);$("#Wbscodeedit1").val(t.wbsCode);$("#calType").val(t.calculationType);$("#modal-default-wbsDelete").modal("show")},error:function(n){console.log(n)}})}function ft(){var t=$("#delete-wbs-id").val().split("-")[1],n=$("#Wbscodeedit1").val(),r=$("#calType").val(),i;if(n.length<=0){alert("wbs code is required!!!");return}i={id:t,WBSCode:n,CalculationType:r};$("#modal-default-overlay").modal("show");$.ajax({type:"PUT",url:"/poec/WBS/EditProjectWBS",data:JSON.stringify(i),contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){if($("#modal-default-overlay").modal("toggle"),i.key==200){$("#modal-default-wbsDelete").modal("toggle");var r="realnode-"+t,u=$("#"+r).children("p").eq(1).html(n)}else $("#global-error-message").html(i.value),$("#modal-danger").modal("show")},error:function(n){console.log(n)}})}function et(){var n=$("#delete-wbs-id").val().split("-")[1];$("#modal-default-overlay").modal("show");$.ajax({type:"Delete",url:"/poec/WBS/DeleteProjectWBS/"+n+"",contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){if($("#modal-default-overlay").modal("toggle"),t.key==200){$("#modal-default-wbsDelete").modal("toggle");var i=$("#realnode-"+n).parent();i.remove()}else $("#global-error-message").html(t.value),$("#modal-danger").modal("show")},error:function(n){console.log(n)}})}function n(){var n=$("#wbsCreatorTable").DataTable();n.clear().draw();n.destroy()}function t(){var n=$("#wbsCreatorTable").DataTable({info:!1,pagingType:"simple"});$('.dataTables_filter input[type="search"]').css({width:"50px",display:"inline-block"})}return{init:function(n){h(n)},getProjectWorks:function(){k()},getProjectLocation:function(){d()},getProjectDesciplines:function(){nt()},getProjectSystems:function(){tt()},getProjectSubSystems:function(){it()},showEditWbsNode:function(n,t){ut(n,t)},editWbsCode:function(){ft()},deleteWbsCode:function(){et()},dropwbs:function(){b()},removeFromWbsType:function(n){removeFromWbsType(n)},addToWbsType:function(n){addToWbsType(n)},getProjectwbsTree:function(n){a(n)},getSystemWBsTree:function(n,t){y(n,t)}}}();