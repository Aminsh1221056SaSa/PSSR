var mdrDocumentDetails=mdrDocumentDetails||function(){function i(){}function r(n){var t=$("#OrderByOptions").val(),i=$("#FilterBy").val(),r=$("#filter-value-dropdown").val(),u=$("#tb-mdrSummary");u.empty();$.ajax({type:"Get",url:"/poec/MDRDocument/GetListSummary?filterByOption="+i+"&sortByOption="+t+"&filterValue="+r,contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){$.each(t,function(t,i){h(i,n)})},error:function(n){console.log(n)}})}function n(n){$.ajax({type:"Get",url:"/poec/MDRDocument/GetMDRDocumentDetails?id="+n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){a(i);u(n);t(n)},error:function(n){console.log(n)}})}function u(n){$.ajax({type:"Get",url:"/poec/MDRDocument/GetMDRDocumentStatusHistory?id="+n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){k();$.each(n,function(n,t){l(t)});d()},error:function(n){console.log(n)}})}function t(n){$.ajax({type:"Get",url:"/poec/MDRDocument/GetMDRDocumentComments?id="+n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){g();$.each(n,function(n,t){c(t)});nt()},error:function(n){console.log(n)}})}function f(n){$("#modal-default-overlay").modal("show");$.ajax({type:"Get",url:"/poec/MDRDocument/GetCommentDetails?commentId="+n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){$("#modal-default-overlay").modal("toggle");$("#mdrcomment-title-edit").val(n.title);$("#edit-commentId").val(n.id);$("#compose-textarea-edit").val(n.description);$("#modal-default-editComment").modal("show")},error:function(n){console.log(n)}})}function e(n){$.ajax({type:"Get",url:"/poec/MDRDocument/GetIssuanceDescription?mdrId="+n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){n!=null&&v(n)},error:function(n){console.log(n)}})}function o(t,i,r){var u=new FormData,f;u.append("file",$("#file-comment")[0].files[0]);f={MDRDocumentId:t,Description:i,Title:r};u.append("jsonString",JSON.stringify(f));$("#modal-default-addComment").modal("toggle");$("#modal-default-overlay").modal("show");$.ajax({type:"Post",url:"/poec/MDRDocument/AddMDRComment",data:u,processData:!1,contentType:!1,success:function(i){$("#modal-default-overlay").modal("toggle");i.key==200?($("#file-comment").val(""),n(t)):($("#global-error-message").html(i.value),$("#modal-danger").modal("show"))},error:function(n){console.log(n)}})}function s(n,i,r,u){var f={id:n,title:i,description:r,MDRDocumentId:u};$("#modal-default-editComment").modal("toggle");$("#modal-default-overlay").modal("show");$.ajax({type:"PUT",url:"/poec/MDRDocument/EditMdrComment",data:JSON.stringify(f),contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){$("#modal-default-overlay").modal("toggle");n.key==200?t(u):($("#global-error-message").html(n.value),$("#modal-danger").modal("show"))},error:function(n){console.log(n)}})}function h(n){var r=$("#tb-mdrSummary"),t=$("<tr><\/tr>"),i;t.append("<td>"+n.title+"<\/td>");t.append("<td>"+n.wbsName+"<\/td>");t.append("<td>"+n.lastStatusName+"<\/td>");i=$("<td><p class='btn btn-danger btn-sm edtit-summary-btn' id='ed-sm-"+n.id+"'><i class='fa fa-edit'><\/i><\/p><\/td>");t.append(i);r.append(t)}function c(n){var r=$("#mdr-CommentTb"),t=$("<tr><\/tr>"),i;t.append("<td>"+n.title+"<\/td>");t.append("<td>"+n.isClear+"<\/td>");t.append("<td>"+n.createDate+"<\/td>");t.append("<td><p class='btn btn-danger mdr-comment-details' data-comId='"+n.id+"'><i class='fa fa-reorder'><\/i><\/p><\/td>");i=$("<td><\/td>");n.hasFilePath!=null&&i.append("<p class='btn btn-info mdr-comment-file' data-comId='"+n.id+"'><i class='fa fa-file'><\/i><\/p>");t.append(i);r.append(t)}function l(n){var i=$("#mdr-statusTb"),t=$("<tr><\/tr>");t.append("<td>"+n.createdDate+"<\/td>");t.append("<td>"+n.statusName+"<\/td>");n.isIFR?t.append("<td><h4 class='text-danger'><i class='fa fa-check'><\/i><\/h4><\/td>"):t.append("<td><h4 class='text-danger'><i class='fa fa-remove'><\/i><\/h4><\/td>");t.append("<td><p class='btn btn-info mdr-status-details' data-path='"+n.filePath+"' data-comId='"+n.id+"'><i class='fa fa-file'><\/i><\/p><\/td>");i.append(t)}function a(n){n.isCompleted?($("#doc-issuance").hide(),$("#doc-comment").hide(),$("#edit-mdr-comment").hide()):($("#doc-issuance").show(),$("#doc-comment").show(),$("#edit-mdr-comment").show());$("#current-mdr-id").val(n.id);$("#current-mdr-title").html(n.title);$("#current-mdr-code").html(n.code);$("#mdr-status").html(n.lastStatusName);$("#current-mdr-createDate").html(n.createdDate);$("#current-mdr-issuance").html(n.lastIssuanceDate);$("#current-mdr-progress").html(n.progress+" %");$("#current-mdr-class").html(b(n.type));$("#next-status-code").val(n.code);$("#next-status-mdrId").val(n.id);$("#next-status-type").val(n.type)}function v(n){$("#next-status-id").val(n.nextStatusId);$("#mdr-nextstatus-Desc").val(n.nextStatusDescription);$("#mdr-status-issuance").html(n.lastStatus);$("#mdr-unClear-count").html(n.unclearComment);$("#mdr-Comment-lastDate").html(n.lastCommentDate);$("#mdr-nextstatus-Desc-desc").html(n.nextStatusDescription);n.type=="2"?$("#confirm-contractor-doc").hide():$("#confirm-contractor-doc").show();$("#modal-default-docIssuance").modal("show")}function y(n,t){var r=$(".timeline"),i;i=t%2==0?$("<li class='time-label'><span class='bg-red'>"+n.createDate+"<\/span><\/li>"):$("<li class='time-label'><span class='bg-green'>"+n.createDate+"<\/span><\/li>");r.append(i)}function p(n){var f=$(".timeline"),r=$("<li><\/li>"),t="bg-blue",i="",u;n.hStatus==1001?(t="bg-yellow",i="fa-bell"):n.hStatus==1002?(t="bg-purple",i="fa-bells"):n.hStatus==1003&&(t="bg-green",i="fa-bullhorn");u=$("<i class='fa "+i+" "+t+"'><\/i>");r.append(u);n.description.length>0&&r.append("<div class='timeline-item'><h3 class='timeline-header'>MDR Status: "+w(n.hStatus)+"<\/h3><div class='timeline-body'>"+n.description+"<\/div><\/div>");f.append(r)}function w(n){var t="";switch(n){case 1001:t="IFC";break;case 1002:t="IFA";break;case 1003:t="AFC"}return t}function b(n){var t="";switch(n){case 1:t="A";break;case 2:t="B"}return t}function k(){var n=$("#mdrStatusTable").DataTable();n.clear().draw();n.destroy()}function d(){$("#mdrStatusTable").DataTable()}function g(){var n=$("#mdrCommentTable").DataTable();n.clear().draw();n.destroy()}function nt(){$("#mdrCommentTable").DataTable()}return{init:function(){i()},getMdrDocumentSummary:function(){r()},getMDRDetails:function(t){n(t)},saveMDRComments:function(n,t,i){o(n,t,i)},getCommentDetails:function(n){f(n)},editMderComment:function(n,t,i,r){s(n,t,i,r)},getIssuanceDescription:function(n){e(n)},saveMDRIssuance:function(n,t,i,r,u,f){saveMDRIssuance(n,t,i,r,u,f)}}}();