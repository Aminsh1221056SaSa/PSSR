var workPackageReport=workPackageReport||function(){function i(n,t){var r=$("#tab-body").attr("data-pathUrl"),i=$("#tab_report");i.empty();$.get(r+"?wId="+n+"&locId="+t,function(n){i.append(n)})}function r(t,i){$("#descipline-summary-loading").show();$.ajax({type:"Get",url:"/poec/Dashboard/GetDesciplineWorkPackageReport?wId="+t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(r){n(r,t,i,"DesciplineId");$("#descipline-summary-loading").hide()},error:function(n){console.log(n)}})}function u(t,i){$("#descipline-summary-loading").show();$.ajax({type:"Get",url:"/poec/Dashboard/GetWorkPackageStepProgress?wId="+t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(r){n(r,t,i,"WorkPackageStepId");$("#descipline-summary-loading").hide()},error:function(n){console.log(n)}})}function f(n,t){$("#system-summary-loading").show();$.ajax({type:"Get",url:"/poec/Dashboard/GetSystemWorkPackageReport?wId="+n,contentType:"application/json; charset=utf-8",dataType:"json",success:function(i){e(i,n,t);$("#system-summary-loading").hide()},error:function(n){console.log(n)}})}function n(n,i,r,u){var o=$("#workPackage-type option:selected").text(),f=Math.max.apply(Math,$.map(n,function(n){return n.items.length})),e;f<=4&&(f=4);e=f*40;$(".progress-top").css({height:e+"px"});$.each(n,function(n,f){var s=$("#body-loc-"+f.locationId+""),h=0,c=0,l=0,e;s.empty();$.each(f.items,function(n,t){var e=parseFloat(t.wf).toFixed(2),o=parseFloat(t.progress).toFixed(2),a=parseFloat(t.pct).toFixed(2);h+=t.wf;c+=t.progress;l+=t.pct;var f=$("<tr><\/tr>"),v=$("<td><a href='/ProjectManagment/Activity/ActivityList?WorkPackageId="+i+"&LocationId="+r+"&"+u+"="+t.id+"'>"+t.name+"<\/a><\/td>"),y=$("<td>"+e+"<\/td>"),p=$("<td>"+o+"<\/td>"),w=$("<td>"+a+"<\/td>");f.append(v).append(y).append(p).append(w);s.append(f)});e=$("#footLoc-"+f.locationId);e.empty();var a=$("<tr><\/tr>"),y=$("<td>Total<\/td>"),p=$("<td>"+parseFloat(h).toFixed(2)+"<\/td>"),w=$("<td>"+parseFloat(c).toFixed(2)+"<\/td>"),b=$("<td>"+parseFloat(l/f.items.length).toFixed(2)+"<\/td>");a.append(y).append(p).append(w).append(b);e.append(a);var v=$("#tb-des-"+f.locationId),k=v.attr("data-name"),d=o+" Summary Report For "+k;t(v,"SummaryReport-"+f.locationId,d)})}function e(n,i,r){var e=$("#workPackage-type option:selected").text(),u=Math.max.apply(Math,$.map(n,function(n){return n.items.length})),f;u<=4&&(u=4);f=u*40;$(".progress-bottom").css({height:f+"px"});$.each(n,function(n,u){var o=$("#body-loc-sys-"+u.locationId+""),f;o.empty();var s=0,h=0,c=0;$.each(u.items,function(n,t){var f=parseFloat(t.wf).toFixed(2),e=parseFloat(t.progress).toFixed(2),l=parseFloat(t.pct).toFixed(2);s+=t.wf;h+=t.progress;c+=t.pct;var u=$("<tr><\/tr>"),a=$("<td><a href='/ProjectManagment/Activity/ActivityList?WorkPackageId="+i+"&LocationId="+r+"&SystemId="+t.id+"'>"+t.name+"<\/a><\/td>"),v=$("<td>"+f+"<\/td>"),y=$("<td>"+e+"<\/td>"),p=$("<td>"+l+"<\/td>");u.append(a).append(v).append(y).append(p);o.append(u)});f=$("#footSys-"+u.locationId);f.empty();var l=$("<tr><\/tr>"),v=$("<td>Total<\/td>"),y=$("<td>"+parseFloat(s).toFixed(2)+"<\/td>"),p=$("<td>"+parseFloat(h).toFixed(2)+"<\/td>"),w=$("<td>"+parseFloat(c/u.items.length).toFixed(2)+"<\/td>");l.append(v).append(y).append(p).append(w);f.append(l);var a=$("#tb-sys-"+u.locationId),b=a.attr("data-name"),k=e+" Summary Report For "+b;t(a,"SummaryReport-"+u.locationId,k)})}function t(n,t,i){n.DataTable().destroy();var n=n.DataTable({paging:!1,info:!1,searching:!1,dom:"Bfrtip",buttons:[{text:"",extend:"excelHtml5",collectionLayout:"fixed two-column ",className:"btn btn-success btn-sm",exportOptions:{modifier:{page:"current"}},init:function(n,t){$(t).removeClass("dt-button");$(t).append('<p class="" style="height:8px"><i style="font-size:16px;color:#FFF;" class="fa fa-file-excel-o"><\/i><p>')},extension:".xlsx",filename:t,messageTop:i,customize:function(n){var t=n.xl.worksheets["sheet1.xml"];$("row",t).each(function(n){n>2&&(n%2==0?$("row:nth-child("+(n+1)+") c",t).attr("s","10"):$("row:nth-child("+(n+1)+") c",t).attr("s","20"))})}},]})}return{init:function(){},getWorkPackageContent:function(n,t){i(n,t)},getWorkPackageDesciplineReport:function(n,t){r(n,t)},getSystemWorkPackageReport:function(n,t){f(n,t)},getWorkPackageWrokStepReport:function(n,t){u(n,t)}}}();