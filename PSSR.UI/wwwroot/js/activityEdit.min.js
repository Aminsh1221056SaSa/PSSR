var activityEdit=function(n){function t(t){n.ajax({type:"Get",url:"/poec/Activity/GetActivityWBSTree?activityWBsId="+t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){n.each(t,function(t,i){if(i.parentId==null)r(i.name,i.id,i.wbsCode);else{var f=n("#node-"+i.parentId+"");u(i.name,i.id,i.wbsCode,f)}})},error:function(n){console.log(n)}})}function r(t,i,r){t=t.split("(")[0];var f="node-"+i,e=n("#first-li-wbs"),o=n("<a id='"+f+"' data-wbsCode='"+r+"' class='drop-wbs'><p  style='width:60px;height:10px'>"+t+"<\/p><p class='html-wbsCode' style='width:60px;height:10px'>"+r+"<\/p><\/a>"),u=n(' <ul id="dr-ul-1001"><\/ul>');e.append(o);u.append(u)}function u(t,i,r,u){var o,f;if(t=t.split("(")[0],o="node-"+i,f=n(u).parent(),f.children("ul").length){var c=f.children("ul").first(),e=n("<li><\/li>"),s=n("<a id='"+o+"' data-wbsCode='"+r+"' class='drop-wbs'><p style='width:auto;height:10px'>"+t+"<\/p><p class='html-wbsCode' style='width:60px;height:10px'>"+r+"<\/p><\/a>");e.append(s);c.append(e)}else{var h=n("<ul><\/ul>"),e=n("<li style='margin-left:-45px;'><\/li>"),s=n("<a id='"+o+"' class='drop-wbs' data-wbsCode='"+r+"'><p style='width:auto;height:10px'>"+t+"<\/p><p class='html-wbsCode' style='width:60px;height:10px'>"+r+"<\/p><\/a>");e.append(s);h.append(e);f.append(h)}}function f(r,u){var f=n("#ac-st-progress").val(),e=n("#ac-status").val(),o=n("#ac-conditon").val(),s=n("#ac-holdBy").val(),c=n("#ac-st-description").val(),h={Id:r,Status:e,HoldBy:s,Progress:f,Condition:o};n("#modal-default-overlay").modal("show");n.ajax({type:"PUT",url:"/poec/activity/UpdateActivityStatus",contentType:"application/json; charset=utf-8",data:JSON.stringify(h),dataType:"json",success:function(f){f.key==200?(t(r),i(r),u.getActivitySummary(),u.getActivityDetails(r),n("#modal-default-overlay").modal("toggle")):(n("#global-error-message").html(f.value),n("#modal-default-overlay").modal("toggle"),n("#modal-danger").modal("show"))},error:function(n){console.log(n)}})}function i(t){n.ajax({type:"Get",url:"/poec/activity/GetActivityStatusHistory?activityId="+t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){h("activityStatusHisTable");n.each(t,function(n,t){o(t,n)});c("activityStatusHisTable")},error:function(n){console.log(n)}})}function e(t){n.ajax({type:"Get",url:"/poec/activity/GetActivityDocuments?activityId="+t,contentType:"application/json; charset=utf-8",dataType:"json",success:function(t){l();n.each(t,function(n,t){s(t,n)});a()},error:function(n){console.log(n)}})}function o(t,i){i=i+1;var r=n("<tr id='tr-"+t.id+"'><\/tr>");r.append("<td>"+i+"<\/td>");r.append("<td>"+t.description+"<\/td>");r.append("<td>"+v(t.holdBy)+"<\/td>");r.append("<td>"+t.createDate+"<\/td>");n("#activity-packages").append(r)}function s(t,i){i=i+1;var r=n("<tr id='tr-"+t.id+"'><\/tr>");r.append("<td>"+i+"<\/td>");r.append("<td>"+t.createdDate+"<\/td>");r.append("<td>"+t.description+"<\/td>");r.append("<td>"+t.punchCode+"<\/td>");r.append("<td><p class='btn btn-info activity-doc-class' data-docId='"+t.id+"'><i class='fa fa-file'><\/i><\/p><\/td>");n("#document-activity").append(r)}function h(){var t=n("#activityStatusHisTable").DataTable();t.clear().draw();t.destroy()}function c(){var t=n("#activityStatusHisTable").DataTable()}function l(){var t=n("#activityDocTable").DataTable();t.clear().draw();t.destroy()}function a(){var t=n("#activityDocTable").DataTable()}function v(n){var t="";switch(n){case 0:t="Normal";break;case 1:t="HoldMaterial";break;case 2:t="HoldSequence";break;case 3:t="HoldOther"}return t}return{init:function(n){t(n);i(n);e(n)},UpdateActivityStatus:function(n,t){f(n,t)}}}(window.jQuery);